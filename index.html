<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title> Jefer's Store </title>
  <link rel="stylesheet"  type="text/css" />
</head>
<body>
    <div class= "container"></div>
    <div class= "details"  style="display: none;"></div>
  
<styles>

  .container {
  display: flex;    
  flex-wrap:  wrap;
  justify-content: space-between;
  padding: 25px;
}

.card {
  margin: 5 px;
  border: 2px solid gray;
  max-width: 300px;
  padding: 15px;
  border-radius: 20px;
  font-family: Arial, Helvetica, sans-serif;
 }
  
</styles>
<script>   
  async function obtenerProductos() {    
    try {
    //  const response = await fetch('https://tiendavirtual.jefersonz1997.repl.co/productos'); 
      const response = await fetch('https://tiendavirtual.jefersonz1997.repl.co/productosfromGraphql')
      if(!response.ok){
         throw new Error('Error en la solicitud');
       }
      const data = await response.json();
      // console.log(data);
      return data;
  }  catch (error) {
     console.error('Error: ', error);
     return [];
   }
}
  // obtenerProductos();

   document.addEventListener("DOMContentLoaded", async () => {
      const container2 = document.querySelector(".container");
      const products = await obtenerProductos();
      let products = "";
      //console.log(products);
     
      products.products.forEach((product) => {
        localStorage.setItem(`product_${product.id}`, JSON.stringify(product));
// template literal se guarda en backtick
      products += ` <div class = "card" style="width: 18 rem;">
      <img src="${product.imagen}" style="width: 100 em" class="card-img-top" alt="...">
      
      <div class="card-body">                                 
        <h5 class="card-text"> ${product.titulo} </h5> 
        <p class="card-text"> ${product.precio} </p>
        <a href="detalleproducto.html?id=${product.id}" 
        class="btn-primary"> Ver detalle </a>
       </div> 
    </div> `;      
        
      });
    container.innerHTML = products;
      });
</script>

</body>
</html>
